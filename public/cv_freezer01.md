---
title: 【Maya】CV値をフリーズするツール【つくってみた】-01 要件定義編-
tags:
  - maya
  - Python
private: false
updated_at: ''
id: null
organization_url_name: null
slide: false
ignorePublish: false
---
# はじめに
- 本記事はMayaツール作成の一連の流れを記事にしたものです
- 今回は例としてCV値をフリーズするツールをつくります
- あくまで個人的なツール作成フローをまとめたものになります
- フローはプロジェクト特性や環境によって変化しうるものです
- フレームワーク等の仰々しいものとしてではなく、日々のツール作成の一助としていただければ幸いです

# 想定読者
- ツールをいくつか作成したことがある
- より踏み込んだツール制作を学びたい
- スケール可能なツール開発に興味がある

# シリーズ構成
- 01 要件定義編(本記事)
- 02 検証編
- 03 作成編
- 04 テスト編
- 05 リリース編

以上の計5編になります

# 要件定義
さっそく要件定義に入っていきます。
以下の手順で進めていきます。
- 1.要望発生
- 2.要望のヒアリング
- 3.要望内容の精査
- 4.要件をまとめる

ここからはやや寸劇チックになりますが、
お付き合いください。

# 1.要望発生
>日々の業務に勤しんでいると、ある日キャラクターモデリングアーティストから、
>「CV値をフリーズするツールを作れませんか？」
>という依頼が来ました。
>細かい内容はわかりませんが、要望の温度感が不明なため、
>明日にヒアリングのMTGを設けることにしました。

大抵の場合はアーティストの要望から始まることが多いです。

他のパターンとしては、
- 能動的にアーティストたちに困っていることがないかをヒアリングする
- ツール要望投函フォーマットを確立し、そこに要望がくる

などがあるでしょうか。
いずれにせよ、プロジェクトの規模、人的リソースを鑑みてベストな方法を取るのが良いと思います。
仕事のための仕事を増やさないことは重要です。

# 2.要望のヒアリング
>TA「昨日のツール要望について詳しく聞かせてもらえますか？」
>Art「はい。モデルを保存する前にいつもCV値をフリーズしているのですが、ワンクリックでできないかなと思いまして」
>TA「なるほど。ちなみにCV値をフリーズするのには理由があったりするのでしょうか？」
>Art「そうですね。プログラマにするように言われました。なんでもエラーになるかもしれないからと」
>TA「わかりました。それでは今行っているフリーズの手順を教えてもらってもいいですか？」
>Art「はい。いろいろと複雑なのであとでチャットで送ります」
>TA「ありがとうございます。要件等を精査しますので、またご連絡します」

無事細かい事情を訊くことができました。

ここでミソになるのはズバリ**要望の目的**です。
会話の中程でTAは**CV値をフリーズする理由**を訊いていますね。
ここでは「プログラマに言われたから」とのことでした。
程度にもよりますが、こういう場合はきちんとプログラマに裏を取るのが賢明です。
理由は単純で、**そもそも作らなくてもよい可能性がある**ためです。
例えば、プログラマに実際に訊いてみたら「今の仕様では必要なくなりました」と言われるかもしれません。

ツールはあくまで問題を解消するためのものであり、
ツールを作ること自体は目的ではありません。
CV値をフリーズする必要がないのであれば、その時間を使って別のツールをつくったほうが有意義ですし、あなたの評価にも繋がります。

# 3.要望内容の精査
要望の妥当性を精査する必要があります。

まずはプログラマに話を訊きにに行きましょう。
>TA「すみません。今お時間よろしいですか？」
>PG「大丈夫ですよ」
>TA「アーティストの方からCV値をフリーズする作業の自動化ツールを頼まれたのですが、CV値をフリーズしない場合の不具合について、詳しく訊いてもいいですか？」
>PG「あぁ、モデルにCV値が入ったままだと、デフォーマ系の結果が意図しないものになるんですよ。スキンバインドとか。紛れ込むとかなりやっかいなのでアーティストにはフリーズしてもらうようにお願いしてます」
>TA「なるほど。ありがとうございます」

裏が取れました。
仕様的に無くなっているということもなさそうです。

ここで要望の順番について整理します。
- モデルにCV値が入っていると、デフォーマ系に不具合が発生する(プログラマ)
↓
- CV値のフリーズをする必要がある(アーティスト)
↓
- CV値のフリーズに手間がかかるためワンクリックで行いたい(アーティスト)

ここまで整理できていれば上々です。
せっかくなので、ワンクリックで行えるようになることの利点も言語化しておきましょう。
色々あるとは思いますが大きくは下記の2点になると思います。
- 工数削減
- 作業精度向上

ここまで来れば、もはやツールを作る妥当性に一点の曇りもありません。

---

そうこうしているうちにアーティストから「CV値のフリーズ手順」のメッセージが届きました。
>【CV値のフリーズ手順】
>①モデルのスキンウェイトをツールで保存する
>②モデルにラティスデフォーマをかける
>③モデルのヒストリを削除する
>④モデルのスキンウェイトをもとに戻す
>
>テストシーンを添付しています。
>キューブの上部4頂点を絞るようにCV値を入れてあります。

どうやらテストシーンデータも一緒に添付してくれたようなので、
まずはこちらを確認してみます。

![image.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/3121056/b1924e4a-a87f-7057-8cb9-58c721381ac3.png)

キューブに2つのジョイントがバインドされています。
メッセージには「キューブ上部の4頂点にCV値を入れてある」と書かれていましたね。

![image.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/3121056/1a6ea010-f2de-75d6-5030-d18a8d7677c4.png)

たしかに4頂点のみにCV値が入っています。

さっそく手順通りにCV値をフリーズしてみましょう。
これがうまくいかなければ前提が覆ってしまうため、
大切な確認になります。

(続きを書く)

(なおスキンウェイトのコピーには[MayaHumToolsのSkinWightsIO](https://github.com/Hum9183/MayaHumTools#skinweightsio)を使用します。各自お好みのコピーツールを使用してください)
# 4.要件をまとめる

### CV値とは
検証編で話す。
ここではCV値が入っているモデルをartからもらった体にする


# 4.1動作環境
maya2018
maya2022
maya2024
